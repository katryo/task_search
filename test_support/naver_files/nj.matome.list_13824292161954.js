/*!
 * $.gmapV3
 * https://gist.github.com/889677
 * is a google maps async loader
 * author: Takeshi Takatsudo (takazudo[at]gmail.com)
 * upate: 2011/03/28
 * version: 1
 */
(function($,window,document,undefined){$.gmapV3=(function(){var gmapV3={};
var _loadFired=false;
var _readyList=[];
var _mapReady=false;
var _options={language:"ja",sensor:false,callbackFnName:"gMapCallback"};
function _load(){var data={language:_options.language,sensor:_options.sensor,callback:_options.callbackFnName};
window[_options.callbackFnName]=_onload||$.noop;
var timer=setInterval(function(){if(document.body){$.ajax({url:"http://maps.google.com/maps/api/js",dataType:"script",data:data,cache:true});
clearInterval(timer);
}},10);
}function _onload(){$(function(){_mapReady=true;
$.each(_readyList,function(i,fn){fn();
});
});
}gmapV3.options=function(o){$.extend(_options,o);
return gmapV3;
};
gmapV3.ready=function(fn){if(_mapReady){fn();
}else{_readyList.push(fn);
}return gmapV3;
};
gmapV3.load=function(){if(_loadFired){return;
}_loadFired=true;
_load();
return gmapV3;
};
return gmapV3;
})();
})(jQuery,this,this.document);
(function($){var CONST={SIDE_SIZE:2,ARROUND_SIZE:2,MAX_REST_SIZE:1,TOTAL:11};
$.widget("ui.njPageNavi",{options:{item:110,itemPerPage:10,page:1,paginateClass:"MdPagination04",paginateBreakClass:"mdPagination04Break",onPaginateComplete:function(){},onPaginateError:function(){},onClickEvent:function(){}},currentPage:1,endPage:1,_create:function(){var self=this,doc=this.element[0],o=this.options;
o.item=parseInt(o.item);
o.itemPerPage=parseInt(o.itemPerPage);
var endNavi=Math.ceil(o.item/o.itemPerPage);
this.setPage(o.page,endNavi);
$(doc).delegate("a","click.njPageNavi",$.proxy(function(e){e.preventDefault();
this._trigger("onClickEvent",null,$(e.target).html());
var _endPage=Math.ceil(o.item/o.itemPerPage);
this.setPage($(e.target).html(),_endPage);
},this));
},getEndPage:function(){var self=this,o=this.options;
return Math.ceil(o.item/o.itemPerPage);
},setTotalItem:function(item){var self=this,o=this.options;
o.item=item;
return true;
},setCurrentPage:function(current){this.currentPage=current;
return true;
},getCurrentPage:function(){return this.currentPage;
},redraw:function(iItem,iTarget){o=this.options;
o.item=iItem;
var endNavi=Math.ceil(iItem/o.itemPerPage);
this.setPage((iTarget)?iTarget:this.currentPage,endNavi);
},setPage:function(currentPage,endPage){var self=this,doc=this.element[0],o=this.options,cpage=parseInt(currentPage),epage=parseInt(endPage);
this.currentPage=cpage;
this.endPage=epage;
var pdiv="",ssize=parseInt(CONST.SIDE_SIZE),asize=parseInt(CONST.ARROUND_SIZE),rsize=parseInt(CONST.MAX_REST_SIZE),total=parseInt(CONST.TOTAL);
var mssize=ssize+asize+rsize;
for(var i=1;
i<=epage;
i++){if(i==(asize+1)&&epage>(mssize+ssize+1)&&cpage>(mssize+1)&&epage>total){pdiv+='<span class="'+o.paginateBreakClass+'">...</span>';
i=(epage-mssize>cpage-asize)?cpage-asize:epage-mssize-1;
}if(i==cpage){pdiv+="<strong>"+i+"</strong>";
}else{pdiv+='<a href="#">'+i+"</a>";
}if((cpage>epage-mssize)&&i<(epage-mssize-asize)&&epage>total){pdiv+='<span class="'+o.paginateBreakClass+'">...</span>';
i=(cpage-asize>epage-mssize)?epage-mssize:cpage-asize-1;
}if(i>(mssize-1)&&i>=(cpage+asize)&&epage>mssize&&i<epage-asize-1&&epage>total){pdiv+='<span class="'+o.paginateBreakClass+'">...</span>';
i=epage-asize;
}}try{this._trigger("onPaginateComplete");
$(doc).html(pdiv);
}catch(e){this._trigger("onPaginateError");
}}});
})(jQuery);
nj.getPackage("nj.matome.list",(function(){var options={itemList:"DIV.MdMTMWidgetList01",inputMenu:"DIV.MdMTMWidgetUtil01 , DIV.MdMTMWidgetUtil02",itemOption:".mdMTMWidget01Util03, .mdMTMWidget01Util02",mode:"default",url:{html:"/api/view/html/item",api:"/api/item/",move:"/api/html/item/move/",drag:"/api/item/move/drop/"},typeCode:"M",encryptId:"",itemTotal:0,isPr:false,isLegalAccess:false,isProofs:false,isOwner:false,isOwnerMember:false,removeInfo:null},templates={SEPARATOR:'<div class="ArSubSeparator04 MdMarginTop16 MdMarginBottom19 FnRakutenTopSeparator"><hr></div>',TWEET_DELETE_BUTTON:'<a title="削除" class="MdMTMWidgetTweetDelBtn01 FnAboneTweet" href="#">削除</a>'},oSearch;
return{init:function(oOptions){$.extend(options,oOptions);
this._initDelegate();
this._initMove();
this._initPage();
this._initRightMenu();
this._initVideo();
this._initDeleteOdai();
this._initDynamicPositionableContent();
this._initPageNavi();
this._initComment();
this._initFixedArea();
this._initFavorite();
this._initMatomeHaritsuke();
this._initTopic();
this._initGroup();
this._initSpotListMap();
this._initAboneTweet();
this._initTwitterIntents();
},_initDelegate:function(){var self=this,itemList=options.itemList;
$(".mdBtn01Add01Btn").click(function(event){if(options.mode=="edit"&&!nj.common.message.confirm("MATOME_EDIT.CONFIRM_DELETE")){event.preventDefault();
return;
}});
$(itemList).bootOn("nj.matome.edit.core").delegate("a.MdBtn02Edit01","click",function(event){event.preventDefault();
if(options.mode=="edit"){nj.common.message.alert("MATOME_EDIT.EDITING_ITEM",{type:"修正"});
return;
}else{options.mode="edit";
}$.rest("GET",{url:nj.common.getAPI("GROUP_LOCK",{missionId:options.missionId}),success:function(o){if(o&&o.result&&o.result.status==="LOCKED"){nj.common.message.alert("MATOME_EDIT.LOCKED_EDIT",{name:o.result.userNick});
}}});
!oSearch&&self._initSearch();
var edit_option=function(sType){return{privateFlag:options.privateFlag,url:options.url.html,search:function(){if(sType){self.search(this,sType);
}},beforeEdit:function(event,sView){$(elEdit).addClass("ExSelected");
$(elEdit).removeClass("MdEditable02");
$(elEdit).trigger("DOMUpdate.mtmDynamicPositionable");
this._editView=sView;
},beforeCancel:function(event,bDiff){if(event.originalEvent.isConfirm!==false){if(bDiff!="false"){if(!nj.common.message.confirm("MATOME_EDIT.CONFIRM_DELETE")){return;
}}}$(elEdit).html(this._editView);
$(elEdit).removeClass("ExSelected");
$(elEdit).addClass("MdEditable02");
$(elEdit).trigger("DOMUpdate.mtmDynamicPositionable");
$(elEdit).find(".mdMTMWidget01Util02,.mdMTMWidget01Util03").hide();
options.mode="default";
},afterCommit:function(){$(elEdit).removeClass("ExSelected");
$(elEdit).addClass("MdEditable02");
$(elEdit).trigger("DOMUpdate.mtmDynamicPositionable");
$(elEdit).find(".mdMTMWidget01Util02, .mdMTMWidget01Util03").hide();
options.mode="default";
},searchCopyRight:function(event,message){var $item;
if(message&&typeof message==="string"){alert(message);
}if($.inArray(event.type,["mtmitemimagesearchcopyright","mtmitemlinksearchcopyright","mtmitemcitesearchcopyright"])!==-1){$item=$(elEdit);
$item.find(".mdBtn01Cancel01Btn").trigger("click",{isConfirm:false});
$item.find(".MdBtn02Del01").trigger("click",{isConfirm:false});
}options.mode="default";
}};
};
var elEdit=$(event.currentTarget).parents(".MdMTMWidget01")[0];
var sEditClass=$(event.currentTarget).parents(".MdMTMWidget01")[0].className;
if(sEditClass.match("mdMTMWidget01TypeLink")){$(elEdit).mtmItemLink(edit_option());
$(elEdit).mtmItemLink("edit");
}else{if(sEditClass.match("mdMTMWidget01TypeImg")){$(elEdit).mtmItemImage(edit_option());
$(elEdit).mtmItemImage("edit");
}else{if(sEditClass.match("mdMTMWidget01TypeVideo")){$(elEdit).mtmItemVideo(edit_option());
$(elEdit).mtmItemVideo("edit");
}else{if(sEditClass.match("mdMTMWidget01TypeQuote")){$(elEdit).mtmItemCite(edit_option("image"));
$(elEdit).mtmItemCite("edit");
}else{if(sEditClass.match("mdMTMWidget01TypeTwitter")){$(elEdit).mtmItemTweet(edit_option());
$(elEdit).mtmItemTweet("edit");
}else{if(sEditClass.match("mdMTMWidget01TypeTxt")){$(elEdit).mtmItemText(edit_option());
$(elEdit).mtmItemText("edit");
}else{if(sEditClass.match("mdMTMWidget01TypeTtl")){$(elEdit).mtmItemTitle(edit_option());
$(elEdit).mtmItemTitle("edit");
}}}}}}}});
$(itemList).bootOn("nj.matome.edit.core").delegate("a.MdBtn02Del01","click",function(event,oData){event.preventDefault();
if(!oData||oData.isConfirm){if(options.mode=="edit"){nj.common.message.alert("MATOME_EDIT.EDITING_ITEM",{type:"削除"});
return;
}if(!nj.common.message.confirm("MATOME_EDIT.CONFIRM_DELETE_NO_RETURN")){return;
}}var remove_option=function(){return{url:options.url.html,privateFlag:options.privateFlag,afterRemove:function(event,result){$(this).remove();
self.removeItem(result);
$(this).trigger("DOMUpdate.mtmDynamicPositionable");
}};
};
var elEdit=$(event.currentTarget).parents(".MdMTMWidget01")[0];
var sEditClass=$(event.currentTarget).parents(".MdMTMWidget01")[0].className;
if(sEditClass.match("mdMTMWidget01TypeLink")){$(elEdit).mtmItemLink(remove_option());
$(elEdit).mtmItemLink("remove");
}else{if(sEditClass.match("mdMTMWidget01TypeImg")){$(elEdit).mtmItemImage(remove_option());
$(elEdit).mtmItemImage("remove");
}else{if(sEditClass.match("mdMTMWidget01TypeVideo")){$(elEdit).mtmItemVideo(remove_option());
$(elEdit).mtmItemVideo("remove");
}else{if(sEditClass.match("mdMTMWidget01TypeQuote")){$(elEdit).mtmItemCite(remove_option());
$(elEdit).mtmItemCite("remove");
}else{if(sEditClass.match("mdMTMWidget01TypeTwitter")){$(elEdit).mtmItemTweet(remove_option());
$(elEdit).mtmItemTweet("remove");
}else{if(sEditClass.match("mdMTMWidget01TypeTxt")){$(elEdit).mtmItemText(remove_option());
$(elEdit).mtmItemText("remove");
}else{if(sEditClass.match("mdMTMWidget01TypeTtl")){$(elEdit).mtmItemTitle(remove_option());
$(elEdit).mtmItemTitle("remove");
}}}}}}}});
},_initDeleteOdai:function(){$(".mdHeading01Util .MdBtn02Del01").bootOn("nj.matome.edit.core").click(function(event){event.preventDefault();
if(nj.common.message.confirm("MATOME_EDIT.CONFIRM_DELETE_NO_RETURN")){$.rest("DELETE",{url:"/api/odai/"+options.missionId,data:"",success:function(response){if(response.error){var errormessage,oMessage={};
switch(response.error.code){case"11200":errormessage="MATOME_EDIT.TITLE_LENGTH";
oMessage={min:5,max:50};
break;
default:errormessage="MATOME_EDIT.ERROR_SERVER";
break;
}nj.common.message.alert(errormessage,oMessage);
}else{document.location.replace("/works");
}},error:function(){}});
}});
},_initMove:function(){var self=this;
$(options.itemList).bootOn("nj.matome.favorite.button").delegate("DIV.MdMTMWidget01","mouseenter.dynamicMenu",function(event){var $el=$(this);
$(options.itemOption).hide();
$el.find(options.itemOption).show();
self._checkFavorite($el);
$(this).data("isMouseover",true);
}).delegate("DIV.MdMTMWidget01","mouseleave.dynamicMenu",function(event){var $related=$(event.relatedTarget),$el=$(this);
if(!$el.data("isShowFavorite")||(!$related.hasClass("mdTooltip01Pointer")&&!$related.hasClass("MdTooltip01"))){$el.find(options.itemOption).hide();
var $btn=$el.find(".MdFVBtn04");
if($btn.data("matome-favoriteButton")){$btn.favoriteButton("tagSetting",false,0);
}}$el.data("isMouseover",false);
});
},_initPage:function(){var self=this,itemList=options.itemList;
var sParam=window.location.search.replace(/(&?)page=[0-9]*/g,"").replace("?&","?");
iThisPageSize=$(".MdMTMWidget01",itemList).length;
$(".MdPagination03").njPageNavi({item:iTotal,itemPerPage:iPageSize,page:iPage,paginateClass:"MdPagination04",paginateBreakClass:"mdPagination04Break",onPaginateComplete:function(){},onPaginateError:function(){},onClickEvent:function(event,sPage){window.location.href=window.location.pathname+((sParam)?sParam+"&":"?")+"page="+sPage;
}});
this.removeItem=function(result){if(result!==null&&typeof result!="object"){var _elAdded=$('<div class="MdMTMWidget01"></div>').appendTo($(itemList)).html(result);
try{var oAddData=$("._jWidgetData",_elAdded).attr("data-contentdata");
if(oAddData){var oAdd={};
oAdd=$.parseJSON(oAddData);
}}catch(e){}_elAdded.addClass(self.selectClass(oAdd));
}try{$(".MdPagination03").njPageNavi("redraw",--iTotal,0);
iThisPageSize=$(".MdMTMWidget01",itemList).length;
if(iTotal===0){window.location.reload();
}}catch(e){}};
if(options.isLegalAccess){setTimeout(function(){try{if(window.top===window.self){var sd=location.protocol+"//"+location.hostname,s=sd+location.pathname,ig=new Image();
ig.src=sd+Base64.decode("L21kcz9yPQ==")+encodeURIComponent(document.referrer)+"&u="+encodeURIComponent(s);
ig.onerror=function(){$(this).remove();
};
$(document.body).append(ig);
}}catch(e){}},2*3*1000);
}},_initSearch:function(){oSearch=$(document.body).mtmSearch({onItemSelect:function($e,$data){$($data.opener).mtmItemCite("setImage",$data.data);
oSearch.mtmSearch("close");
}});
},_initVideo:function(){var self=this,itemList=options.itemList;
$(itemList).delegate("DIV.mdMTMWidget01ItemVideo01","mouseenter.videoview",function(event){var _video=$("P.mdMTMWidget01ItemVideo01View",this);
$("P.mdMTMWidget01ItemVideo01View > A",this).filter(function(){return !$(this).find(".mdMTMWidget01ItemVideo01Play03Txt").length;
}).njVideoFilter({onCompleteShow:function(){var self=this;
setTimeout(function(){$(self).trigger("DOMUpdate.mtmDynamicPositionable");
},1000);
},viewArea:"P.mdMTMWidget01ItemVideo01View",width:"480",height:"360"});
});
$(itemList).delegate("div.mdMTMWidget01TypeTwitter","mouseenter.videoview",function(event){$("a.MdVideoThumb01",this).njVideoFilter({onCompleteShow:function(){var self=this;
setTimeout(function(){$(self).trigger("DOMUpdate.mtmDynamicPositionable");
},1000);
},viewArea:"div.mdMTMWidget01ItemTweetMedia01Body",width:"300",height:"225"});
});
},_initRightMenu:function(){var jqRightMenu=$("DIV.MdSubUserMTM01").length?$("DIV.MdSubUserMTM01"):$("DIV.MdSubPaticipant01").length?$("DIV.MdSubPaticipant01"):null;
jqRightMenu&&jqRightMenu.mtmMenuRight({missionId:options.missionId,userHash:options.userHash,onDOMUpdate:function($e){jqRightMenu.trigger("DOMUpdate.mtmDynamicPositionable");
}});
},_initDynamicPositionableContent:function(){var jqDynamicPositionableContent=$("DIV.ArSubWrap01").mtmDynamicPositionable({});
},search:function(oThis,sType){oSearch.mtmSearch("open",{type:sType,opener:oThis});
},_initComment:function(){var o=options,elFixed,nScroll=0;
elFixed=$(".MdMTMViewHead01");
if(elFixed.length){nScroll=-elFixed.height();
}nj.Bootloader.exec("nj.matome.social",function(){$(".MdCommentForm01").mtmComment({mode:"insert",encryptId:o.encryptId,typeCode:o.typeCode,scrollDiff:nScroll});
$(".MdCommentItem01").mtmComment({mode:"list",encryptId:o.encryptId,typeCode:o.typeCode,scrollDiff:nScroll});
$(".mdCommentForm01InputTxt").njPlaceholder();
});
},_initPageNavi:function(){var o=options,elFixed,nScroll=0;
elFixed=$(".MdMTMViewHead01");
if(elFixed.length){nScroll=-elFixed.height();
}nj.Bootloader.exec("nj.matome.social",function(){var cl=$("ul.MdCommentList01").mtmCommentSet({encryptId:o.encryptId});
$(".MdPagination04").njPageNavi({item:o.itemTotal,onClickEvent:function(e,n){cl.mtmCommentSet("setArgs",{page:n});
cl.mtmCommentSet("setScrollDiff",nScroll);
cl.mtmCommentSet("getComment");
}});
});
},_initFixedArea:function(){var elFixedHead=$(".MdMTMViewHead01"),elShuffle=elFixedHead.find(".mdMTMViewHead01Util");
elFixedHead.mtmFixedBlock({onExceed:function(){elShuffle.show();
},onLess:function(){elShuffle.hide();
}});
},_initFavorite:function(){var $counter,$favBtn,$btn,elCounter,elBtn;
if(options.isPr){$counter=$(".mdHeading04CountFV .mdHeading04CountNum");
$favBtn=$(".MdFVBtn06");
}if(!options.isPr||(!$counter.length&&!$favBtn.length)){$counter=$(".mdHeading01CountFV .mdHeading01CountNum .mdHeading01FVIco").get(0)||$([]);
$counter=$($counter.nextSibling);
$favBtn=$(".MdFVBtn01");
}elCounter=$(".MdMTMReaction01 .mdFVCount01Num").get(0);
elBtn=$(".MdMTMReaction01 .MdFVBtn03").get(0);
elCounter&&$counter.push(elCounter);
elBtn&&$favBtn.push(elBtn);
if($.isArray($favBtn)){$favBtn=$($favBtn);
}var $dfd=$.Deferred();
$favBtn.bootOn("nj.matome.favorite.button").hook("mouseenter",function(e){$dfd.resolve();
$favBtn.each(function(){if(e.target===this||e.target.parentNode===this){var $fav=$(this);
if($fav.favoriteButton("isEnable")){$fav.favoriteButton("tagSetting",true);
return false;
}}});
});
$dfd.promise();
$dfd.then(function(){var b=$counter.length&&$favBtn.favoriteUpdater;
if(b){$favBtn.favoriteUpdater({counter:$counter,disable:options.isProofs});
$favBtn.each(function(){var $el=$(this),isTop=$el.hasClass("MdFVBtn01");
$el.favoriteButton("option",{positionLabel:isTop?"top-left":"bottom-left",marginPosition:{top:isTop?1:-1}});
});
}return b;
});
},_initMatomeHaritsuke:function(){$(".mdSocialBtn01Paste").matomePasteButton({query:{id:options.missionId}});
},_checkFavorite:function($item){var $button=$item.find(".MdFVBtn04"),oData,sUrl;
if($button.length&&!$button.data("favorite-check")){$button.favoriteButton({disable:options.isProofs,appendTarget:$item.find(".mdMTMWidget01Util03"),positionLabel:"top-left",marginPosition:{top:1,left:-1},onShowTagSetting:function(){$item.data("isShowFavorite",true);
var $tooltip=$button.find(".MdTooltip01");
$tooltip.css("width",$tooltip.width());
},onHideTagSetting:function(){$item.data("isShowFavorite",false);
if(!$item.data("isMouseover")){$item.find(options.itemOption).hide();
}}}).data("favorite-check",true);
if(options.isProofs){return;
}oData=$item.find("._jWidgetData").data("contentdata");
if(oData&&oData.favorite){$button.favoriteButton("enable");
}else{$button.favoriteButton("disable");
}$button.one("mouseenter",function(){if($button.favoriteButton("isEnable")){$button.favoriteButton("tagSetting",true);
}});
}},_initTopic:function(){$(".mdBtn01AddTopic01Btn").bootOn("nj.matome.topicList").hook("click");
},_initGroup:function(){if($(".FnJoinUserList,.FnInviteUserList,.FnRequestUserList,.FnMinnaUserList").length){nj.Bootloader.script("nj.matome.group");
}else{$("#FnMatomeInvite,#FnMatomeJoin").bootOn("nj.matome.group").hook("click");
}},selectClass:function(oData){var sClassname="";
switch(oData.type){case"S":sClassname="mdMTMWidget01TypeLink";
break;
case"I":sClassname="mdMTMWidget01TypeImg";
break;
case"V":sClassname="mdMTMWidget01TypeVideo";
break;
case"Q":sClassname="mdMTMWidget01TypeQuote";
break;
case"T":sClassname="mdMTMWidget01TypeTwitter";
break;
case"X":sClassname="mdMTMWidget01TypeTxt";
break;
case"H":sClassname="mdMTMWidget01TypeTtl";
break;
}return sClassname;
},_initSpotListMap:function(){var LOCATION_LINK=".MdMTMWidget01:not(.ExSelected) .mdLocation01Link",$main=$("div.ArMain01"),$locationLink=$main.find(LOCATION_LINK);
$main.delegate(LOCATION_LINK,"click",function(event){event.preventDefault();
var $elm=$(this);
if($elm.data("disabled")===true){return false;
}$elm.data("disabled",true);
$.gmapV3.load();
$.gmapV3.ready(function(){nj.Bootloader.exec("nj.matome.list.map",function(){var contentData=$elm.parents(".MdMTMWidget01").find("._jWidgetData").data("contentdata");
var editMapItem=new nj.matome.list.Map({missionId:contentData.missionId,contentId:contentData.contentId,onClose:function(){$elm.data("disabled",false);
}});
return false;
});
});
});
},_initAboneTweet:function(){var fRemoveItem=function($item){$item&&$item.fadeOut(function(){$(this).remove();
});
},$item,oInfo=options.removeInfo,sTargetContentId=oInfo?oInfo.contentId:null;
if(!options.isOwner&&!options.isOwnerMember){$(".MdMTMWidgetList01").delegate(".mdMTMWidget01TypeTwitter","mouseenter",function(e){var $item=$(this);
if(!$item.find(".FnAboneTweet").length){$item.find(".mdMTMWidget01Util03 a").eq(0).before(templates.TWEET_DELETE_BUTTON);
}});
}if(oInfo&&oInfo.error){nj.Bootloader.exec("nj.matome.edit.abone.twitter",function(){nj.matome.edit.abone.twitter.selfRemove.showFailTwitterAuthMessage();
});
}if(oInfo){$item=(function(){var $target;
$(".mdMTMWidget01TypeTwitter").each(function(){var $item=$(this),oData=$item.find("._jWidgetData").data("contentdata");
if(oData.contentId==oInfo.contentId){$target=$(this);
return false;
}});
return $target;
})();
(function(){var $prev=$item.prev().find(".mdMTMWidget01Content01"),nTop=0;
if(!$prev.length){$prev=$(".LyTop");
}nTop=$prev.offset().top+$prev.height();
if($.browser.mozilla){$("html").scrollTop(nTop);
}else{document.body.scrollTop=nTop;
}})();
nj.Bootloader.exec("nj.matome.edit.abone.twitter",function(){nj.matome.edit.abone.twitter.selfRemove({missionId:options.missionId,contentId:oInfo.contentId,userHash:g_userHash},oInfo).next(function(bResult){if(bResult){fRemoveItem($item);
}else{nj.common.message.alert("COMMON.SERVER_ERROR");
}});
});
}$(".ArMain01").bootOn("nj.matome.edit.abone.twitter").delegate(".FnAboneTweet","click",function(e){var $item=$(this).parents(".MdMTMWidget01"),oData=$item.find("._jWidgetData").data("contentdata");
nj.matome.edit.abone.twitter.selfRemove({missionId:options.missionId,contentId:oData.contentId,userHash:g_userHash},sTargetContentId===oData.contentId?oInfo:null).next(function(bResult){if(bResult){fRemoveItem($item);
}else{nj.common.message.alert("COMMON.SERVER_ERROR");
}});
return false;
});
},_initTwitterIntents:function(){nj.Bootloader.script("http://platform.twitter.com/widgets.js");
}};
})());
(function(){var oList={"youtu.be":{r:/(?:http:\/\/)?.*youtu\.be\/(.*?)$/,n:"YouTube",w:640,h:385,th:"http://i.ytimg.com/vi/<<0>>/default.jpg",ht:$.browser.msie?'<object width="<<width>>" height="<<height>>"><param name="movie" value="http://www.youtube.com/v/<<0>>?autoplay=1&version=3&amp;hl=ja_JP"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/<<0>>?autoplay=1&version=3&amp;hl=ja_JP" type="application/x-shockwave-flash" width="<<width>>" height="<<height>>" allowscriptaccess="always" allowfullscreen="true"></embed></object>':'<iframe width="<<width>>" height="<<height>>" src="http://www.youtube.com/embed/<<0>>?autoplay=1&wmode=transparent" frameborder="0" allowfullscreen></iframe>'},"youtube.com":{r:/(?:http:\/\/)?.*youtube.com\/(?:watch\?v=|v\/)(.{11})/,n:"YouTube",w:640,h:385,th:"http://i.ytimg.com/vi/<<0>>/default.jpg",ht:$.browser.msie?'<object width="<<width>>" height="<<height>>"><param name="movie" value="http://www.youtube.com/v/<<0>>?autoplay=1&version=3&amp;hl=ja_JP"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/<<0>>?autoplay=1&version=3&amp;hl=ja_JP" type="application/x-shockwave-flash" width="<<width>>" height="<<height>>" allowscriptaccess="always" allowfullscreen="true"></embed></object>':'<iframe width="<<width>>" height="<<height>>" src="http://www.youtube.com/embed/<<0>>?autoplay=1&wmode=transparent" frameborder="0" allowfullscreen></iframe>'},"video.yahoo.com":{r:/(?:http:\/\/)?video.yahoo.com\/watch\/(.*)\/(.*)/,n:"Yahoo! Video",w:640,h:385,ht:'<iframe frameborder="0" width="<<width>>" height="<<height>>" src="http://d.yimg.com/nl/vyc/site/player.html#vid=<<1>>"></iframe>'},"screen.yahoo.com":{r:/(?:http:\/\/)?screen.yahoo.com\/.+-([0-9]+)\.html/,n:"Yahoo! screen",w:576,h:324,ht:'<iframe frameborder="0" width="<<width>>" height="<<height>>" src="http://d.yimg.com/nl/vyc/site/player.html#vid=<<0>>"></iframe>'},"vids.myspace.com":{r:/(?:http:\/\/)?vids.myspace.com\/index\.cfm\?fuseaction=.*=(.*)/,n:"MySpaceTV Videos",w:640,h:385,ht:['<object width="<<width>>px" height="<<height>>px"  classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">','<param name="allowFullScreen" value="true"/>','<param name="wmode" value="transparent"/>','<param name="movie" value="http://mediaservices.myspace.com/services/media/embed.aspx/m=<<0>>,t=1,mt=video"/>','<embed src="http://mediaservices.myspace.com/services/media/embed.aspx/m=<<0>>,t=1,mt=video" width="<<width>>" height="<<height>>" allowFullScreen="true" type="application/x-shockwave-flash" wmode="transparent"></embed>',"</object>"].join("")},"www.metacafe.com":{r:/(?:http:\/\/)?www.metacafe.com\/watch\/(.*)\/.+/,n:"Metacafe",w:640,h:385,ht:'<embed flashVars="playerVars=showStats=yes|autoPlay=no|videoTitle=Play The Impossible" src="http://www.metacafe.com/fplayer/<<0>>/play_the_impossible.swf" width="<<width>>" height="<<height>>" wmode="transparent" allowFullScreen="true" allowScriptAccess="always" name="Metacafe_<<0>>" pluginspage="http://www.macromedia..com/go/getflashplayer" type="application/x-shockwave-flash"></embed>'},"www.watchme.tv":{r:/(?:http:\/\/)?www.watchme.tv\/v\/\?mid=(.*)/,n:"ワッチミーTV",w:640,h:385,th:"http://www.watchme.tv/n/b/0b/v/<<0>>/sample_1.jpg",ht:['<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="external<<0>>" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,115,0" width="<<width>>" height="<<height>>" align="middle">','<param name="movie" value="http://www.watchme.tv/flash/P3O.swf?mid=<<0>>" />','<param name="allowScriptAccess" value="always" />','<embed src="http://www.watchme.tv/flash/P3O.swf?mid=<<0>>" type="application/x-shockwave-flash" width="<<width>>" height="<<height>>" allowScriptAccess="always"></embed>',"</object>"].join("")},"eyevio.jp":{r:/(?:http:\/\/)?eyevio.jp\/movie\/(.*)/,n:"eyeVio",w:640,h:385,ht:'<iframe src="http://eyevio.jp/embed.do?movieId=<<0>>&amp;width=<<width>>&amp;height=<<height>>" style="margin: 0px; width: <<width>>px; height: <<height>>px;" frameborder="0" scrolling="no"></iframe>'},"www.stickam.com":{r:/(?:http:\/\/)?www.stickam.com\/viewMedia\.do\?mId=(.*)/,n:"Stickam Japan",w:640,h:385,ht:'<embed wmode="opaque" src="http://player.stickam.com/flashVarMediaPlayer/<<0>>" type="application/x-shockwave-flash" wmode="transparent" scale="noscale" allowFullScreen="true" width="<<width>>" height="<<height>>" allowScriptAccess="always"></embed>'},"www.gametrailers.com":{r:/(?:http:\/\/)?www.gametrailers.com\/(?:(?:video\/(.*)\/(.*))|(?:player(\/)(.*)\.html))/,n:"gametrailer.com",w:640,h:385,ht:'<embed src="http://media.mtvnservices.com/mgid:moses:video:gametrailers.com:<<1>><<3>>" width="<<width>>" height="<<height>>" type="application/x-shockwave-flash" allowFullScreen="true" allowScriptAccess="always" base="." flashVars=""></embed>'},"www.livevideo.com":{r:/(?:http:\/\/)?www.livevideo.com\/video.*\/(.*)\/.*.aspx/,n:"LiveVideo.com",w:640,h:385,ht:'<embed type="application/x-shockwave-flash"  src="http://www.livevideo.com/livetv/embed/<<0>>" width="<<width>>" height="<<height>>" />'},"www.vimeo.com":{r:/(?:http:\/\/)?www.vimeo.com\/(.*)/,n:"vimeo",w:640,h:385,ht:'<iframe src="http://player.vimeo.com/video/<<0>>?color=c9ff23" width="<<width>>" height="<<height>>" frameborder="0"></iframe>'},"www.tudou.com":{r:/(?:http:\/\/)?www.tudou.com\/programs\/view\/(.*)\//,n:"Tudou.com",w:640,h:385,ht:'<embed src="http://www.tudou.com/v/<<0>>" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="opaque" width="<<width>>" height="<<height>>"></embed>'},"you.video.sina.com.cn":{r:/(?:http:\/\/)?you.video.sina.com.cn\/b\/(.*)-(.*).html/,n:"sina.com",w:640,h:385,ht:['<object id="ssss" width="<<width>>" height="<<height>>"  classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">','<param name="allowScriptAccess" value="always" />','<embed pluginspage="http://www.macromedia..com/go/getflashplayer" src="http://you.video.sina.com.cn/api/sinawebApi/outplayrefer.php/vid=<<0>>_<<1>>/s.swf type="application/x-shockwave-flash" name="ssss" allowFullScreen="true" allowScriptAccess="always" width="<<width>>" height="<<height>>"></embed>',"</object>"].join("")},"revver.com":{r:/(?:http:\/\/)?revver.com\/video\/(.*)\/.+/,n:"Revver",w:640,h:385,th:"http://frame.revver.com/frame/120x90/<<0>>.jpg",ht:'<script src="http://flash.revver.com/player/1.0/player.js?mediaId:<<0>>;width:<<width>>;height:<<height>>;" type="text/javascript"><\/script>'},"www.dailymotion.com":{r:/(?:http:\/\/)?www.dailymotion.com\/video\/([^_]*)/,n:"Dailymotion",w:640,h:385,ht:$.browser.msie?['<object width="<<width>>" height="<<height>>" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">','<param name="movie" value="http://www.dailymotion.com/swf/<<0>>"></param>','<param name="wmode" value="transparent"></param>','<param name="allowfullscreen" value="true"></param>','<embed type="application/x-shockwave-flash" src="http://www.dailymotion.com/swf/<<0>>" width="<<width>>" height="<<height>>"  wmode="transparent" allowfullscreen="true"></embed>',"</object>"].join(""):'<iframe frameborder="0" width="<<width>>" height="<<height>>" src="http://www.dailymotion.com/embed/video/<<0>>"></iframe>'},"www.nicovideo.jp":{r:/(?:http:\/\/)?www.nicovideo.jp\/watch\/(.*)/,n:"ニコニコ動画(原宿)",w:640,h:385,ht:"ニコニコ動画(原宿)"},"vimeo.com":{r:/(?:http:\/\/)?vimeo.com\/(.*)/,n:"Vimeo",w:480,h:270,ht:'<iframe src="http://player.vimeo.com/video/<<0>>?&autoplay=1" width="<<width>>" height="<<height>>" frameborder="0"></iframe>'},"www.facebook.com":{r:/(?:http:\/\/)?www.facebook.com\/(?:video\/video\.php|photo\.php)\?v=([0-9]+)/,n:"Facebook",w:400,h:224,ht:'<object width="<<width>>" height="<<height>>" ><param name="allowfullscreen" value="true" /><param name="movie" value="http://www.facebook.com/v/<<0>>" /><embed src="http://www.facebook.com/v/<<0>>" type="application/x-shockwave-flash" allowfullscreen="true" width="<<width>>" height="<<height>>"></embed></object>'},"channel.pandora.tv":{r:function(sUrl){var aPath=sUrl.split("?"),aParam=aPath[1]?aPath[1].split("&"):[],aResult=[null],aMatch;
for(var i=0,n=aParam.length;
i<n;
i++){aMatch=aParam[i].match(/^ch_userid=(.+)$/);
if(aMatch&&aMatch[1]){aResult[1]=aMatch[1];
}aMatch=aParam[i].match(/^prgid=(.+)$/);
if(aMatch&&aMatch[1]){aResult[2]=aMatch[1];
}}return aResult;
},n:"PANDORA.TV",w:500,h:402,ht:'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="<<width>>" height="<<height>>" id="movie" align="middle"><param name="quality" value="high" /><param name="movie" value="http://flvr.pandora.tv/flv2pan/flvmovie.dll/userid=<<0>>&amp;prgid=<<1>>&amp;skin=1&countryChk=jp" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /><param name="wmode" value="transparent" /><embed src="http://flvr.pandora.tv/flv2pan/flvmovie.dll/userid=<<0>>&amp;prgid=<<1>>&amp;skin=1&countryChk=jp" type="application/x-shockwave-flash" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" pluginspage="http://www.macromedia.com/go/getflashplayer" width="<<width>>" height="<<height>>" /></embed></object>'},"www.ustream.tv":{r:/(?:http:\/\/)?www.ustream.tv\/recorded\/(.*)($|#)/,n:"USTREAM",w:480,h:270,ht:'<iframe src="http://www.ustream.tv/embed/recorded/<<0>>" width="<<width>>" height="<<height>>" scrolling="no" frameborder="0" style="border: 0px none transparent;"></iframe>'},"v.youku.com":{r:/(?:http:\/\/)?v.youku.com\/v_show\/id_(.+)\.html/,n:"youku",w:480,h:400,ht:'<embed src="http://player.youku.com/player.php/sid/<<0>>/v.swf" allowFullScreen="true" quality="high" width="<<width>>" height="<<height>>" align="middle" wmode="transparent" allowScriptAccess="always" type="application/x-shockwave-flash"></embed>'},"video.fc2.com":{r:/(?:http:\/\/)?video.fc2.com\/content.*?\/(20[0-9]{6}.{8})\/?$/,n:"FC2動画",w:480,h:392,ht:'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" wmode="transparent" width="<<width>>" height="<<height>>" id="flv2" align="middle"><param name="allowScriptAccess" value="sameDomain" /><param name="movie" value="http://video.fc2.com/flv2.swf?i=<<0>>" /><param name="quality" value="high" /><param name="bgcolor" value="#ffffff" /><param name="allowFullScreen" value="true" /><embed src="http://video.fc2.com/flv2.swf?i=<<0>>" quality="high" bgcolor="#ffffff" wmode="transparent" width="<<width>>" height="<<height>>" name="flv2" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" allowFullScreen="true" /></object>'},"www.yinyuetai.com":{r:/(?:http:\/\/)?www.yinyuetai.com\/(?:(?:playlist)|(?:video))\/([0-9]+)\/?/,n:"YinYueTai.com",w:480,h:334,ht:'<embed src="http://www.yinyuetai.com/video/player/<<0>>/v_0.swf" quality="high" width="<<width>>" height="<<height>>" align="middle"  allowScriptAccess="sameDomain" type="application/x-shockwave-flash"></embed>'},"yfrog.com":{r:/(?:http:\/\/)?yfrog.com\/(.+)/,n:"yfrog",w:480,h:334,ht:'<iframe width="<<width>>" height="<<height>>" src="http://yfrog.com/<<0>>:embed" scrolling="no" frameborder="0" style="border: 0px none transparent;"><other/></iframe>'},"www.flickr.com":{r:/(?:http:\/\/)?www.flickr.com\/photos\/.+\/(.+)\/?/,n:"flickr",w:400,h:225,ht:'<object type="application/x-shockwave-flash" width="<<width>>" height="<<height>>" data="http://www.flickr.com/apps/video/stewart.swf?v=<<0>>" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"><param name="flashvars" value="intl_lang=en-us&photo_secret=238d59b90e&photo_id=4153025406"></param><param name="movie" value="http://www.flickr.com/apps/video/stewart.swf?v=<<0>>"></param><param name="bgcolor" value="#000000"></param><param name="allowFullScreen" value="true"></param><embed type="application/x-shockwave-flash" src="http://www.flickr.com/apps/video/stewart.swf?v=<<0>>" bgcolor="#000000" allowfullscreen="true" flashvars="intl_lang=en-us&photo_secret=238d59b90e&photo_id=4153025406" height="<<height>>" width="<<width>>"></embed></object>'},"twitvideo.jp":{r:function(sUrl){var aResult=sUrl.match(/(?:http:\/\/)?twitvideo.jp\/(.+)/);
if(aResult&&aResult[1]){aResult.push(aResult[1]+(+new Date()));
}return aResult;
},n:"twitvideo",w:600,h:420,ht:'<p id="<<1>>"></p><script type="text/javascript">var sc = document.createElement("script");sc.src = "http://twitvideo.jp/js/fmp.js";sc.onload = function() {var FO = {  movie:"http://twitvideo.jp/swf/dVideoPlayerVer2.swf",width:"<<width>",height:"<<height>>",  majorversion:"7",build:"0",bgcolor:"#FFFFFF",allowfullscreen:"true",wmode:"transparent",  flashvars:"BOI01=6ea3d4ee031f401a871f5b67c57b714d855777286394e08a78ab2738883cf47337f9594c5d1edc686880118ecaf5c464a8e04de0856a0c7b509566dc2c1cd2fc7aee71c6cc30ea097beb5f3e861fdbce&BOI02=92bf7ffcc32c88c6ba882e5e7c020e21782ccff159ad84b322504156e538de7c541774998a37226007d84a8418f84fb0fd4b4491100e5318878498c7c86914b7&BOI03=1b038fb10a71b63112540e39f02f8115&BOI04=ya_nyan" };UFO.create( FO, "<<1>>");};document.getElementsByTagName("head")[0].appendChild(sc);<\/script>'}};
oList["www.myspace.com"]=$.extend({},oList["vids.myspace.com"],{r:/(?:http:\/\/)?www.myspace.com\/video\/.+\/.+\/([0-9]+)\/?/});
$.njVideoFilter=$.njVideoFilter||{};
$.njVideoFilter.list=oList;
$.njVideoFilter.isPlayable=function(url){var isPlayable=false,re,matches;
for(var s in oList){re=oList[s].r;
matches=$.isFunction(re)?re(url):url.match(re);
if(matches&&matches.length>1){isPlayable=true;
break;
}}return isPlayable;
};
})();
(function($){var mFilter=nj.getPackage("mFilter",{reg:/https?:\/\/([^\/]*)/,_buildVeoh:function(site,n,url){try{var t=site.ht;
var th="";
var _s=url.split("/");
if(!_s){return;
}var uid=_s[_s.length-1];
t=t.replace(/<<0>>/g,uid);
return{url:"http://"+n,html:t,thumb:th,name:site.n,width:site.w,height:site.h};
}catch(e){return false;
}},isYoutube:function(url){var a=this.reg.exec(url);
return a[1]&&/youtube/.test(a[1]);
},html:function(url,nWidth,nHeight){var n,site,r,a,t,width,height,th;
if(!this.reg.test(url)){return false;
}n=this.reg.exec(url)[1];
if(/youtube/.test(n)){n="youtube.com";
}site=this.site[n];
if(typeof site=="undefined"){return false;
}if($.isFunction(site.r)){r=site.r(url);
}else{r=site.r.exec(url);
}a=[];
if(!r){return false;
}if(n=="www.veoh.com"){return this._buildVeoh(site,n,url);
}for(var i=1;
i<r.length;
i++){a[i-1]=r[i];
}t=site.ht;
for(i=0;
i<a.length;
i++){t=t.replace(new RegExp("<<"+i+">>","g"),a[i]||"");
}if(n=="youtube.com"){nWidth=nWidth||"480";
nHeight=nHeight||"360";
}width=nWidth||site.w;
height=nHeight||site.h;
t=t.replace(new RegExp("<<width>>","g"),width);
t=t.replace(new RegExp("<<height>>","g"),height);
th=site.th||"";
for(i=0;
i<a.length;
i++){th=th.replace(new RegExp("<<"+i+">>","g"),a[i]);
}return{url:"http://"+n,html:t,thumb:th,name:site.n,width:site.w,height:site.h};
},site:{}});
mFilter.site=$.njVideoFilter.list;
var njVideoFilter={options:{width:460,height:300,onCompleteShow:function(){}},_create:function(){var self=this;
var doc=$(self.element[0]);
this.doc=doc;
doc.bind("click.njVideoFilter",function(e){e.preventDefault();
self.show();
});
doc.bind("mouseover.njVideoFilter",function(e){self._over();
});
doc.bind("mouseout.njVideoFilter",function(e){self._out();
});
},_init:function(){},_destroy:function(){},show:function(){var url,moni;
if(typeof this.options.viewArea!="undefined"){url=$(this.element).attr("href");
moni=$(this.element).parents(this.options.viewArea);
}else{url=$(this.element).children("a").attr("href");
moni=$(this.element);
}var o=this.options;
var _h=385*(o.width/640);
if(url.match("nicovideo.jp")){this.setNico(url,moni,o.width,o.height);
$(this.element).unbind("click.njVideoFilter");
$(this.element).unbind("mouseover.njVideoFilter");
$(this.element).unbind("mouseout.njVideoFilter");
this._trigger("onCompleteShow");
}else{var mf=mFilter.html(url,o.width,o.height);
if(mf){var $video=$(mf.html);
moni.html($video);
if($.browser.msie){this.checkVideoCleanUp($video);
}$(this.element).unbind("click.njVideoFilter");
$(this.element).unbind("mouseover.njVideoFilter");
$(this.element).unbind("mouseout.njVideoFilter");
this._trigger("onCompleteShow");
}else{window.open(url,"");
}}},checkVideoCleanUp:function($video){setTimeout(function(){var $embed=$video.find("embed");
if($embed.length){var frag=document.createDocumentFragment();
var embed=$embed[0];
var id=setInterval(function(){if(!$embed.parents("body").length){clearInterval(id);
var el=embed.parentNode;
if(el&&el.tagName==="OBJECT"){frag.appendChild(el);
el.removeChild(embed);
frag.removeChild(el);
}else{frag.appendChild(embed);
frag.removeChild(embed);
}}},1000);
}},500);
},setNico:function(url,moni,width,height,onSuccess){try{var contentsID=url.replace(/^.*\/watch\/(.*)$/i,"$1");
var output=[];
var _returnEmbed="";
document._write=document.write;
document.write=function(v){output.push(v);
};
width=(width)?width:"480";
height=(height)?height:"360";
$.getScript("http://ext.nicovideo.jp/thumb_watch/"+contentsID+"?w="+width+"&h="+height,function(data,textStatus){_returnEmbed=output.join("");
if($.browser.msie||$.browser.webkit){_returnEmbed=_returnEmbed.replace("bgcolor","wmode").replace("#000000","opaque");
}$(moni).html(_returnEmbed);
output=[];
document.write=document._write;
onSuccess&&$.isFunction(onSuccess)&&onSuccess.apply(null,[_returnEmbed]);
});
}catch(e){}},_over:function(){},_out:function(){}};
$.widget("ui.njVideoFilter",njVideoFilter);
$.extend(mFilter,{setNico:njVideoFilter.setNico});
})(jQuery);
(function($){$.widget("matome.mtmMenuRight",(function(WIDGET_NAME){var SELECTOR={TITLE:"H2.MdSubTtl01",ITEM_COUNTER:"H2.MdSubTtl01 > SPAN.mdSubTtl01Num",OPENER_BUTTON:"H2.MdSubTtl01 > A",PAGE_NAVIGATION:{CONTAINER:"P.MdPagination02",PREV_BUTTON:"A.mdPagination02Prev",NEXT_BUTTON:"A.mdPagination02Next",INFO:"SPAN.mdPagination02PageInfo"}},CLASS={OPENER_BUTTON:{OPEN:"MdIcnSlide01Open",CLOSE:"MdIcnSlide01Close"},PAGE_BUTTON_DISABLED:"ExDisabled"},TEXT={CREATOR:"作成者",PARTICIPANT:"参加者",OPENER_BUTTON:{OPEN:"開く",CLOSE:"閉じる"},ITEM_COUNTER:{PREFIX:"（",SUFFIX:"）"}},N_STAT_CODE={ATTRIBUTE:"data-na",OPENER_BUTTON:{OPEN:"NC:expand",CLOSE:"NC:contract"}},EVENT={ON_DOM_UPDATE:"onDOMUpdate"};
var mtmMenuRight={options:{missionId:"",userHash:"",myServiceUrl:"http://pick.naver.jp",itemLengthOnContracted:0,itemLengthForPagination:0,onDOMUpdate:function($e){}},_create:function(){if(!this.options.missionId||!this.options.userHash){return;
}this._oElement=this.element[0];
this._sTitle=$($(SELECTOR.TITLE,this._oElement).contents()[0]).text();
this._initSubClass();
this._oItemCounter=$(SELECTOR.ITEM_COUNTER,this._oElement);
this._nItemTotalLength=this._itemCounter();
this._initOpenerButton();
this._initPageNavigation();
this._oListAPIRequester=new ListAPIRequester();
},_init:function(){},_initOpenerButton:function(){this._oOpenerButton=$(SELECTOR.OPENER_BUTTON,this._oElement);
this._oOpenerButton.click($.proxy(function($e){$e.preventDefault();
this.isExpanded()?this.contract():this.expand();
},this));
},_initPageNavigation:function(){this._nCurrentPage=1;
this._oPageNavigation=$(SELECTOR.PAGE_NAVIGATION.CONTAINER,this._oElement);
this._oPageNavigationPrevButton=$(SELECTOR.PAGE_NAVIGATION.PREV_BUTTON,this._oPageNavigation);
this._oPageNavigationNextButton=$(SELECTOR.PAGE_NAVIGATION.NEXT_BUTTON,this._oPageNavigation);
this._oPageNavigationInfo=$(SELECTOR.PAGE_NAVIGATION.INFO,this._oPageNavigation);
this._oPaginator=new nj.common.PageCalculator({totalLength:this._nItemTotalLength,lengthPerPage:this.options.itemLengthForPagination,onValueUpdate:$.proxy(function($event){this._updatePageInfo($event.currentPage,$event.totalPages);
this._oPaginator.enable();
},this),onPageChange:$.proxy(function($event){this._oPaginator.disable();
this._loadList($event.currentPage,$event.lengthPerPage);
},this)});
this._oPageNavigationPrevButton.click($.proxy(function($e){$e.preventDefault();
this._oPaginator.prevPage();
},this));
this._oPageNavigationNextButton.click($.proxy(function($e){$e.preventDefault();
this._oPaginator.nextPage();
},this));
var oPageInfo=this._oPaginator.getPageInfo();
this._updatePageInfo(oPageInfo.currentPage,oPageInfo.totalPages);
},_initSubClass:function(){if(this._sTitle.indexOf(TEXT.CREATOR)>=0){UserMatomeList.apply(this);
}else{if(this._sTitle.indexOf(TEXT.PARTICIPANT)>=0){ParticipatedUserList.apply(this);
}else{throw new Error("Cannot found strings for identifying");
}}},_itemCounter:function($itemLength){if(arguments.length){this._oItemCounter.text(TEXT.ITEM_COUNTER.PREFIX+String($itemLength)+TEXT.ITEM_COUNTER.SUFFIX);
return $itemLength;
}else{var itemCount=this._oItemCounter.text();
return Number(itemCount.slice(1,itemCount.length-1));
}},_updatePageInfo:function($currentPage,$totalPages){this._nCurrentPage=$currentPage;
this._oPageNavigationInfo.text($currentPage+"/"+$totalPages);
if($currentPage==1){this._oPageNavigationPrevButton.addClass(CLASS.PAGE_BUTTON_DISABLED);
}else{this._oPageNavigationPrevButton.removeClass(CLASS.PAGE_BUTTON_DISABLED);
}if($currentPage==$totalPages){this._oPageNavigationNextButton.addClass(CLASS.PAGE_BUTTON_DISABLED);
}else{this._oPageNavigationNextButton.removeClass(CLASS.PAGE_BUTTON_DISABLED);
}},_toggleOpenerButton:function(){this._oOpenerButton.toggleClass(CLASS.OPENER_BUTTON.CLOSE+" "+CLASS.OPENER_BUTTON.OPEN);
if(this.isExpanded()){this._oOpenerButton.attr(N_STAT_CODE.ATTRIBUTE,N_STAT_CODE.OPENER_BUTTON.OPEN).attr("title",TEXT.OPENER_BUTTON.CLOSE).text(TEXT.OPENER_BUTTON.CLOSE);
}else{this._oOpenerButton.attr(N_STAT_CODE.ATTRIBUTE,N_STAT_CODE.OPENER_BUTTON.CLOSE).attr("title",TEXT.OPENER_BUTTON.OPEN).text(TEXT.OPENER_BUTTON.OPEN);
}},_onLoadListSuccess:function($response){var nTotalLength=$response.result["total"];
var nLengthPerPage=$response.result["pageSize"];
var nCurrentPage=$response.result["page"];
this._oPaginator.setValue(nTotalLength,nLengthPerPage,nCurrentPage);
this._getList($response.result["items"]).appendTo(this._oListContainer.empty());
this._trigger(EVENT.ON_DOM_UPDATE);
},_onLoadListFail:function(){var pageInfo=this._oPaginator.getPageInfo();
this._oPaginator.setValue(pageInfo.totalLength,pageInfo.lengthPerPage,this._nCurrentPage);
},isExpanded:function(){if(this._oOpenerButton.hasClass(CLASS.OPENER_BUTTON.OPEN)){return false;
}else{if(this._oOpenerButton.hasClass(CLASS.OPENER_BUTTON.CLOSE)){return true;
}}},expand:function(){this._toggleOpenerButton();
this._oPageNavigation.show();
var pageInfo=this._oPaginator.getPageInfo();
var currentElementList=this._oListContainer.children();
if(currentElementList.length<pageInfo.currentLength){this._loadList(pageInfo.currentPage,pageInfo.lengthPerPage);
}else{this._oListContainer.children().each($.proxy(function($index,$element){if(($index>=this.options.itemLengthOnContracted)&&($index<pageInfo.lengthPerPage)){$($element).show();
}},this));
}this._trigger(EVENT.ON_DOM_UPDATE);
},contract:function(){this._toggleOpenerButton();
this._oPageNavigation.hide();
var pageInfo=this._oPaginator.getPageInfo();
this._oListContainer.children().each($.proxy(function($index,$element){if($index>=this.options.itemLengthOnContracted){$($element).hide();
}},this));
this._trigger(EVENT.ON_DOM_UPDATE);
}};
var UserMatomeList=(function(){var CONST={ITEM_LENGTH_ON_CONTRACT:2,ITEM_LENGTH_FOR_PAGINATION:10},SELECTOR={LIST_CONTAINER:"UL.mdSubList01Ul"},TEMPLATE={ITEM:$.template(null,['<li class="mdSubList01Li"><a class="mdSubList01Link MdCF" href="${linkUrl}" data-na="NL:link">{{if imageUrl}}<span class="mdSubList01Thumb"><img alt="" src="${imageUrl}" onerror="errorImage(this, \'photo40\')"></span>{{/if}}<span class="mdSubList01Txt"><span class="mdSubList01Ttl">${name}</span><span class="mdSubList01PVCount">view: ${totalViewCount}</span></span></a></li>'].join(""))};
return function(){$.extend(this.options,{itemLengthOnContracted:CONST.ITEM_LENGTH_ON_CONTRACT,itemLengthForPagination:CONST.ITEM_LENGTH_FOR_PAGINATION});
this._oListContainer=$(SELECTOR.LIST_CONTAINER,this._oElement);
this._loadList=function($page,$pageSize){this._oListAPIRequester.request({method:ListAPIRequester.OWNER_MATOME_LIST,userHash:this.options.userHash,page:$page,pageSize:$pageSize,onSuccess:$.proxy(this._onLoadListSuccess,this),onError:$.proxy(this._onLoadListFail,this)});
};
this._getList=function($resultItems){var itemValuesList=[];
$($resultItems).each($.proxy(function($index,$resultItem){itemValuesList.push({linkUrl:nj.getCombinedUrl([nj.getBaseUrl(),"odai",$resultItem.missionId]),imageUrl:$resultItem.imageUrl,name:escapeHTML($resultItem.shortenName||$resultItem.name),totalViewCount:$resultItem.totalViewCount});
},this));
return $.tmpl(TEMPLATE.ITEM,itemValuesList);
};
};
})();
var ParticipatedUserList=(function(){var CONST={ITEM_LENGTH_ON_CONTRACT:8,ITEM_LENGTH_FOR_PAGINATION:40,MY_SERVICE_URL_SUFFIX:"post/matomeParticipation"},SELECTOR={LIST_CONTAINER:"UL.mdSubThumbList01Ul"},TEMPLATE={ITEM:$.template(null,['<li class="mdSubThumbList01Li"><a href="${linkUrl}" data-na="NL:link"><img title="${userNick}さん" alt="" src="${imageUrl}" onerror="errorImage(this, \'user51x51\')"></a></li>'].join(""))};
return function(){$.extend(this.options,{itemLengthOnContracted:CONST.ITEM_LENGTH_ON_CONTRACT,itemLengthForPagination:CONST.ITEM_LENGTH_FOR_PAGINATION});
this._oListContainer=$(SELECTOR.LIST_CONTAINER,this._oElement);
this._loadList=function($page,$pageSize){this._oListAPIRequester.request({method:ListAPIRequester.JOIN_USER_LIST,missionId:this.options.missionId,page:$page,pageSize:$pageSize,onSuccess:$.proxy(this._onLoadListSuccess,this),onError:$.proxy(this._onLoadListFail,this)});
};
this._getList=function($resultItems){var itemValuesList=[];
$($resultItems).each($.proxy(function($index,$resultItem){itemValuesList.push({linkUrl:nj.getCombinedUrl([this.options.myServiceUrl,encodeURI($resultItem.userNick),CONST.MY_SERVICE_URL_SUFFIX]),imageUrl:$resultItem.profileImageUrl||"/matome_ver4/html/sample/img/dummy.png",userNick:$resultItem.userNick});
},this));
return $.tmpl(TEMPLATE.ITEM,itemValuesList);
};
};
})();
var ListAPIRequester=(function(){var API={OWNER_MATOME_LIST:{URL:nj.getCombinedUrl(nj.getBaseUrl(),"api/matome/list/${userHash}/${page}/${pageSize}"),METHOD:"GET"},JOIN_USER_LIST:{URL:nj.getCombinedUrl(nj.getBaseUrl(),"api/user/join/list/${missionId}/${page}/${pageSize}"),METHOD:"GET"}};
var ListAPIRequester=function(){this._isRequesting=false;
};
ListAPIRequester.OWNER_MATOME_LIST="OWNER_MATOME_LIST";
ListAPIRequester.JOIN_USER_LIST="JOIN_USER_LIST";
ListAPIRequester.prototype={request:function($oOptions){$oOptions=$.extend({},{method:"",missionId:"",userHash:"",page:0,pageSize:0,onSuccess:function($e){},onError:function($e){}},$oOptions);
var oAPIInfo=API[$oOptions.method];
if(this._isRequesting||!oAPIInfo){return;
}var sMethod=oAPIInfo.METHOD;
var sUrl=nj.replaceStr(oAPIInfo.URL,{missionId:$oOptions.missionId,itemId:$oOptions.itemId,userHash:$oOptions.userHash,page:$oOptions.page,pageSize:$oOptions.pageSize});
this._isRequesting=true;
$.rest(sMethod,{url:sUrl,success:$.proxy(function($oResponse){var bIsError=$oResponse.error;
if(!bIsError){$oOptions.onSuccess.apply(null,arguments);
}else{$oOptions.onError.apply(null,arguments);
}this._isRequesting=false;
},this),error:$.proxy(function($oResponse){$oOptions.onError.apply(null,arguments);
this._isRequesting=false;
},this)});
}};
return ListAPIRequester;
})();
var escapeHTML=function($sStr){var entities={'"':"quot","&":"amp","<":"lt",">":"gt","'":"#39"};
var s=$sStr.replace(/[<>&"']/g,function(m0){return entities[m0]?"&"+entities[m0]+";":m0;
});
return s;
};
return mtmMenuRight;
})("matome.mtmMenuRight"));
})(jQuery);
(function(){$.widget("matome.mtmFixedBlock",{options:{limitTarget:".lyContentsWrap",fixedClass:"mdMTMViewHead01Fixed",scrollLeftElement:".mdMTMViewHead01Wrap",limit:0,speed:500,diff:-3,onExceed:function(){},onLess:function(){}},_create:function(){$.extend(this,{_elBody:document.body,_bAnimate:false,_bShow:false,_nHeight:0,_nFollowTop:0,_bIE8:$.browser.msie&&$.browser.version>7,_sDummyMarginProp:$.browser.msie?"padding-top":"margin-top",_elDummyMargin:this.element.next(),_elScrollLeft:this.element.find(this.option("scrollLeftElement"))});
if(!$.browser.webkit){this._elBody=document.getElementsByTagName("html")[0];
}$(window).bind("scroll.mtmFixedBlock",$.proxy(this._onScroll,this));
$.browser.msie&&$(window).bind("resize.mtmFixedBlock",$.proxy(this._onHorizontalScroll,this));
},_init:function(){this.reflow();
this.element.css("top",-this._nHeight+"px");
},reflow:function(){var nLimit=0,elLimit,elTop,oOption=this.option();
elLimit=$(oOption.limitTarget);
elTop=elLimit.prev();
nLimit=elLimit.offset().top;
$.each(["margin-bottom","padding-bottom"],function(n,sProp){nLimit-=parseInt(elTop.css(sProp))||0;
});
nLimit=Math.ceil(nLimit);
nLimit+=oOption.diff;
this.option("limit",nLimit);
this._nHeight=this.element.height();
this._nFollowTop=nLimit+this._nHeight;
},_onScroll:function(){var nHeight=this.element.height();
if(nHeight!==this._nHeight){this.reflow();
}this._onHorizontalScroll();
this._onVerticalScroll();
},_onHorizontalScroll:function(){var nLeft;
nLeft=this._elBody.scrollLeft;
if(nLeft===this._nBeforeLeft){return;
}this._elScrollLeft.css("left",-nLeft+"px");
this._nBeforeLeft=nLeft;
},_onVerticalScroll:function(){var oOption,self,nTop,nRest,nRestSp;
nTop=this._elBody.scrollTop;
if(nTop===this._nBeforeTop){return;
}self=this;
oOption=this.option();
if(nTop>oOption.limit){if(!this._bAnimate){if(this._bShow){if(nTop<this._nFollowTop&&nTop<this._nBeforeTop){nRest=nTop-this._nFollowTop;
this.element.css("top",nRest+"px");
setTimeout(function(){if(self._elBody.scrollTop===nTop){nRestSp=1-Math.abs(nRest)/self._nHeight;
self._hide(oOption.speed*nRestSp);
}},50);
}else{if(this.element.css("top")!=="0px"){this._show(oOption.speed);
}}}else{if(nTop>this._nBeforeTop){this._show(oOption.speed);
}}}}else{if(this._bShow||(this._bAnimate&&!this._bShow)){this._stop();
this._hide(0);
}}this._nBeforeTop=nTop;
},_stop:function(){this.element.stop();
},_show:function(nSpeed,nTop){var oOption=this.option(),self=this;
this._bAnimate=true;
this.element.addClass(oOption.fixedClass);
this._elDummyMargin.css(this._sDummyMarginProp,this._nHeight+"px");
this._trigger("onExceed");
this.element.animate({top:nTop||0},nSpeed,function(){self._bAnimate=false;
self._bShow=true;
});
this.element.njLayerSupport();
},_hide:function(nSpeed,nTop){var oOption=this.option(),self=this;
this._bAnimate=true;
this.element.animate({top:nTop||-this._nHeight},nSpeed,function(){self._bAnimate=false;
self._bShow=false;
self.element.removeClass(oOption.fixedClass);
if(self._bIE8){self._elDummyMargin.css(self._sDummyMarginProp,"1px");
setTimeout(function(){self._elDummyMargin.css(self._sDummyMarginProp,"");
},0);
}else{self._elDummyMargin.css(self._sDummyMarginProp,"");
}self._trigger("onLess");
self.element.njLayerSupport("remove");
});
}});
})();
$.widget("matome.matomePasteButton",{options:{url:"/pasteSettings",query:{id:"",listIframe:"true"},name:"blog",window:{width:630,height:860,scrollbars:"yes",resizable:"yes"}},_create:function(){var that=this;
this.element.click(function(e){e.preventDefault();
that._open();
});
},_open:function(){var sUrl=this._getUrl(),sOption=this._getOptionString();
window.open(sUrl,this.option("name"),sOption);
},_getUrl:function(){var a=[];
$.each(this.option("query"),function(i,s){a.push(i+"="+s);
});
return this.option("url")+"?"+a.join("&");
},_getOptionString:function(){var a=[];
$.each(this.option("window"),function(i,s){a.push(i+"="+s);
});
return a.join(",");
}});
(function($){$.widget("matome.mtmDynamicPositionable",(function(WIDGET_NAME){var CONST={UPDATE_INTERVAL:100,UPDATE_INTERVAL_COUNT:10},SELECTOR={LEFT:{CONTENT:"DIV.MdMTMWidgetList01",AD:".ArMain02,.ArMain03"},RIGHT:{CONTENT:"DIV.lySubInner",CONTENT_AD:"DIV.ArSub02"}};
return{options:{},_create:function(){this._jqLeftContent=$(SELECTOR.LEFT.CONTENT);
this._jqLeftAd=$(SELECTOR.LEFT.AD);
this._jqRightContent=$(SELECTOR.RIGHT.CONTENT);
this._jqContentAd=$(SELECTOR.RIGHT.CONTENT_AD,this.element);
if(!this._jqLeftContent.length||!this._jqLeftAd.length||!this._jqRightContent.length){return;
}this._update();
$(window).scroll($.proxy(this._update,this));
$(document).bind("DOMUpdate.mtmDynamicPositionable",$.proxy(this._onDOMUpdate,this));
},_onDOMUpdate:function($e){this._nUpdateInterval&&clearInterval(this._nUpdateInterval);
this._nIntervalCount=CONST.UPDATE_INTERVAL_COUNT;
this._nUpdateInterval=setInterval($.proxy(function(){this._update();
if(!this._nIntervalCount){clearInterval(this._nUpdateInterval);
this._nUpdateInterval=null;
}this._nIntervalCount--;
},this),CONST.UPDATE_INTERVAL);
},_update:function($e){if(this._isRepositionNecessary()){this.element.css({position:"absolute",top:this._getContentTop()+this._getAdjustmentTop()});
}else{!this._isContentStatic()&&this.element.css("position","static");
}},_getAdjustmentTop:function(){return 0;
},_getContentTop:function(){return parseInt(parseInt(this._jqLeftAd.offset().top)-(this.element.height()-this._jqContentAd.height())-parseInt(this._jqRightContent.offset().top));
},_isContentStatic:function(){return this.element.css("position")=="static";
},_isRepositionNecessary:function(){var nLeftContentTop=this._jqLeftContent.offset().top;
var nLeftContentHeight=this._jqLeftContent.height();
var nRightContentTop=this._jqRightContent.offset().top;
var nRightContentHeight=this._jqRightContent.height();
var nElementHeight=this.element.height();
var nComparableLeft=nLeftContentTop+nLeftContentHeight;
var nComparableRight=nRightContentTop+nRightContentHeight-(this._isContentStatic()?nElementHeight:0);
return(nComparableLeft>nComparableRight)&&(this._getContentTop()>(nComparableRight-nRightContentTop));
},_addResizeEvent:function($jqElement,$fnEventListener){$jqElement.resize($fnEventListener);
if(!$jqElement[0].addEventListener){return;
}$jqElement.data("size",{width:$jqElement.width(),height:$jqElement.height()});
$jqElement[0].addEventListener("DOMSubtreeModified",function($e){var jqElement=$(this);
setTimeout(function(){if(jqElement.data("size").height!=jqElement.height()||jqElement.data("size").width!=jqElement.width()){jqElement.data("size",{width:jqElement.width(),height:jqElement.height()});
jqElement.trigger("resize");
}},10);
},false);
}};
})("matome.mtmDynamicPositionable"));
})(jQuery);
(function($){var LAYER_CLASS="FnLayerSupportOverlay";
$.widget("ui.njLayerSupport",{_init:function(){if(!$.browser.msie){return;
}if(($("embed").length||$("object").length)&&!this.element.find("."+LAYER_CLASS).length){this._setIframe();
}},_setIframe:function(){var $iframe=$("<iframe></iframe>"),$el,sPos;
this._$iframe&&this._$iframe.remove();
$iframe.attr({frameborder:0,scrolling:"no"}).css({width:"100%",height:"100%",position:"absolute",top:0,left:0,background:"#000",opacity:"-1000"}).addClass(LAYER_CLASS);
this.element.children().each(function(){$el=$(this);
sPos=$el.css("position");
if(sPos!=="absolute"){$el.css("position","relative").data("beforePosition",sPos);
}});
this.element.prepend($iframe);
this._$iframe=$iframe;
},remove:function(){var $el,sPos;
this._$iframe&&this._$iframe.remove();
this.element.children().each(function(){$el=$(this);
sPos=$el.data("beforePosition");
$el.css("position",sPos).data("beforePosition","");
});
}});
})(jQuery);
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var output="";
var chr1,chr2,chr3,enc1,enc2,enc3,enc4;
var i=0;
input=Base64._utf8_encode(input);
while(i<input.length){chr1=input.charCodeAt(i++);
chr2=input.charCodeAt(i++);
chr3=input.charCodeAt(i++);
enc1=chr1>>2;
enc2=((chr1&3)<<4)|(chr2>>4);
enc3=((chr2&15)<<2)|(chr3>>6);
enc4=chr3&63;
if(isNaN(chr2)){enc3=enc4=64;
}else{if(isNaN(chr3)){enc4=64;
}}output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);
}return output;
},decode:function(input){var output="";
var chr1,chr2,chr3;
var enc1,enc2,enc3,enc4;
var i=0;
input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");
while(i<input.length){enc1=this._keyStr.indexOf(input.charAt(i++));
enc2=this._keyStr.indexOf(input.charAt(i++));
enc3=this._keyStr.indexOf(input.charAt(i++));
enc4=this._keyStr.indexOf(input.charAt(i++));
chr1=(enc1<<2)|(enc2>>4);
chr2=((enc2&15)<<4)|(enc3>>2);
chr3=((enc3&3)<<6)|enc4;
output=output+String.fromCharCode(chr1);
if(enc3!=64){output=output+String.fromCharCode(chr2);
}if(enc4!=64){output=output+String.fromCharCode(chr3);
}}output=Base64._utf8_decode(output);
return output;
},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");
var utftext="";
for(var n=0;
n<string.length;
n++){var c=string.charCodeAt(n);
if(c<128){utftext+=String.fromCharCode(c);
}else{if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);
utftext+=String.fromCharCode((c&63)|128);
}else{utftext+=String.fromCharCode((c>>12)|224);
utftext+=String.fromCharCode(((c>>6)&63)|128);
utftext+=String.fromCharCode((c&63)|128);
}}}return utftext;
},_utf8_decode:function(utftext){var string="";
var i=0;
var c=c1=c2=0;
while(i<utftext.length){c=utftext.charCodeAt(i);
if(c<128){string+=String.fromCharCode(c);
i++;
}else{if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);
string+=String.fromCharCode(((c&31)<<6)|(c2&63));
i+=2;
}else{c2=utftext.charCodeAt(i+1);
c3=utftext.charCodeAt(i+2);
string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));
i+=3;
}}}return string;
}};


/* @release 1382429670 */